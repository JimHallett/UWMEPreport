sampleYear == 2014
sampleYear = 2014
library(RODBC)
library(tidyr)
library(dplyr)
#########################################################################################################
## Initiate report variables
#########################################################################################################
sampleYear = 2014
#########################################################################################################
# Open SQL channel and fetch
#########################################################################################################
channel <- odbcConnect("discountasp", uid = "SQL2008_508574_uwmep_user", pwd = "Manis9") #this creates a connection to the database and reads the server from discountasp.dsn, and provides user credentials.
UTM <-sqlFetch(channel, "UTMs")  # read data from SQL database
glimpse(UTM)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear )
View(UTMsampleYear)
View(UTMsampleYear)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
select(-Year1:-Year3)
View(UTM)
View(UTM)
View(UTMsampleYear)
View(UTMsampleYear)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
select(-Year1:-Prelim)
View(UTMsampleYear)
View(UTMsampleYear)
View(UTM)
View(UTM)
View(UTMsampleYear)
View(UTMsampleYear)
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, FlexTable(UTMsampleYear))
reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
install.packages("ReportRs")
library( ReporteRs )
install.packages("ReporteRs")
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, FlexTable(UTMsampleYear))
reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
library( ReporteRs )
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, FlexTable(UTMsampleYear))
reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, FlexTable(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, FlexTable(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, vanilla.table(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
#########################################################################################################
options('ReporteRs-fontsize'=11, 'ReporteRs-default-font'='Times New Roman')
#########################################################################################################
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, vanilla.table(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
#########################################################################################################
options('ReporteRs-fontsize'=11, 'ReporteRs-default-font'='Times New Roman')
#########################################################################################################
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, vanilla.table(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
options('ReporteRs-fontsize'=11, 'ReporteRs-default-font'='Times New Roman')
#########################################################################################################
reportout = docx()
reportout = addSection( reportout, landscape = FALSE)
reportout = addFlexTable(reportout, light.table(UTMsampleYear))
#reportout = addSection( reportout )
writeDoc( reportout, file = "Sampling.docx")
View(UTMsampleYear)
View(UTMsampleYear)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear )
View(UTMsampleYear)
View(UTMsampleYear)
glimpse(UTM)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(Year1 + Year2 + Year3)
View(UTMsampleYear)
View(UTMsampleYear)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(as.factor(Year1) + as.factor(Year2) + as.factor(Year3))
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(as.string(Year1) + as.string(Year2) + as.string(Year3))
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(toString(Year1) + toString(Year2) + toString(Year3))
glimpse(UTM)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(allyears = toString(Year1) + toString(Year2) + toString(Year3))
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(allyears = as.character(Year1) + as.character(Year2) + as.character(Year3))
class(UTM)
class(UTMsampleYear)
UTM$Yr1 = as.character(Year1)
View(UTM)
View(UTM)
UTM$Yr1 = as.character(UTM$Year1)
View(UTM)
View(UTM)
glimpse(UTM)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(YearsSampled = paste(Yr1, Yr2, Yr3, sep = ', '))
View(UTM)
View(UTM)
UTM$Yr2 = as.character(UTM$Year2)
UTM$Yr3 = as.character(UTM$Year3)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(YearsSampled = paste(Yr1, Yr2, Yr3, sep = ', '))
View(UTM)
View(UTM)
View(UTMsampleYear)
View(UTMsampleYear)
View(UTM)
View(UTM)
UTMsampleYear <- UTM %>%
filter(Year1 == sampleYear | Year2 == sampleYear | Year3 == sampleYear ) %>%
mutate(YearsSampled = paste(Yr1, Yr2, Yr3, sep = ', ')) %>%
select(-Year1:-Prelim, -Yr1:-Yr3)
View(UTMsampleYear)
View(UTMsampleYear)
